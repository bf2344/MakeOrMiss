{"ast":null,"code":"import _classCallCheck from \"/Users/silva/Desktop/code/MakeOrMiss/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/silva/Desktop/code/MakeOrMiss/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/silva/Desktop/code/MakeOrMiss/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/silva/Desktop/code/MakeOrMiss/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/silva/Desktop/code/MakeOrMiss/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/silva/Desktop/code/MakeOrMiss/client/src/pages/DV3.js\";\nimport React from \"react\";\nimport * as d3 from \"d3\";\nimport WCdata from '../assets/wclinedata.csv';\nimport ECdata from '../assets/eclinedata.csv';\n\nvar DV3 =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DV3, _React$Component);\n\n  function DV3() {\n    _classCallCheck(this, DV3);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DV3).apply(this, arguments));\n  }\n\n  _createClass(DV3, [{\n    key: \"CM\",\n    value: function CM() {\n      var data = [[120, [\"like\", \"call response\", \"dramatic intro\", \"has breaks\", \"male vocalist\", \"silly\", \"swing\"]], [150, [\"brassy\", \"like\", \"calm energy\", \"female vocalist\", \"swing\", \"fun\"]], [170, [\"calm energy\", \"instrumental\", \"swing\", \"like\", \"happy\"]], [140, [\"has breaks\", \"male vocalist\", \"swing\", \"piano\", \"banjo\", \"chill\"]], [160, [\"calm energy\", \"instrumental\", \"swing\", \"like\", \"interesting\"]], [140, [\"brassy\", \"like\", \"energy\", \"dramatic intro\", \"male vocalist\", \"baseball\", \"swing\"]], [170, [\"instrumental\", \"interesting\", \"high energy\", \"like\", \"swing\"]], [140, [\"instrumental\", \"energy\", \"like\", \"swing\"]], [200, [\"instrumental\", \"brassy\", \"dramatic intro\", \"like\", \"swing\"]], [160, [\"male vocalist\", \"brassy\", \"swing\", \"like\", \"my favorites\"]], [130, [\"like\", \"interesting\", \"dramatic intro\", \"male vocalist\", \"silly\", \"swing\", \"gospel\"]], [160, [\"like\", \"long intro\", \"announcer\", \"energy\", \"swing\", \"female vocalist\"]], [170, [\"instrumental\", \"swing\", \"bass\", \"like\"]], [150, [\"like\", \"interesting\", \"has breaks\", \"instrumental\", \"chunky\", \"swing\", \"banjo\", \"trumpet\"]], [170, [\"like\", \"has breaks\", \"male vocalist\", \"silly\", \"swing\", \"banjo\"]], [190, [\"instrumental\", \"banjo\", \"swing\"]], [130, [\"instrumental\", \"brassy\", \"banjo\", \"like\", \"swing\"]], [160, [\"brassy\", \"like\", \"energy\", \"instrumental\", \"big band\", \"jam\", \"swing\"]], [150, [\"like\", \"male vocalist\", \"live\", \"swing\", \"piano\", \"banjo\", \"chill\"]], [150, [\"like\", \"trick ending\", \"instrumental\", \"chunky\", \"swing\", \"chill\"]], [120, [\"brassy\", \"like\", \"female vocalist\", \"swing\", \"chill\", \"energy buildup\"]], [150, [\"brassy\", \"like\", \"interesting\", \"instrumental\", \"swing\", \"piano\"]], [190, [\"brassy\", \"like\", \"long intro\", \"energy\", \"baseball\", \"swing\", \"female vocalist\"]], [180, [\"calm energy\", \"female vocalist\", \"live\", \"like\", \"swing\"]], [200, [\"banjo\", \"like\", \"long intro\", \"interesting\", \"energy\", \"my favorites\", \"male vocalist\", \"silly\", \"swing\", \"fun\", \"balboa\"]], [150, [\"brassy\", \"calm energy\", \"chunky\", \"instrumental\", \"old-timey\", \"live\", \"swing\"]], [160, [\"like\", \"call response\", \"interesting\", \"instrumental\", \"calm energy\", \"swing\"]], [180, [\"interesting\", \"swing\", \"fast\", \"male vocalist\"]], [150, [\"calm energy\", \"chunky\", \"swing\", \"female vocalist\", \"like\"]], [180, [\"like\", \"has breaks\", \"male vocalist\", \"chunky\", \"silly\", \"swing\"]], [140, [\"instrumental\", \"brassy\", \"dramatic intro\", \"swing\", \"chill\"]], [150, [\"male vocalist\", \"trumpet\", \"like\", \"swing\"]], [150, [\"instrumental\", \"energy\", \"like\", \"has breaks\", \"swing\"]], [180, [\"brassy\", \"like\", \"energy\", \"has breaks\", \"instrumental\", \"has calm\", \"swing\"]], [150, [\"female vocalist\", \"swing\"]], [170, [\"instrumental\", \"brassy\", \"energy\", \"swing\"]], [170, [\"calm energy\", \"instrumental\", \"energy\", \"like\", \"swing\"]], [190, [\"brassy\", \"like\", \"instrumental\", \"high energy\", \"swing\", \"trumpet\"]], [160, [\"male vocalist\", \"energy\", \"swing\", \"old-timey\"]], [170, [\"like\", \"oldies\", \"my favorites\", \"fast\", \"male vocalist\", \"high energy\", \"swing\"]]]; // transform the data into a useful representation\n      // 1 is inner, 2, is outer\n      // need: inner, outer, links\n      //\n      // inner: \n      // links: { inner: outer: }\n\n      var outer = d3.map();\n      var inner = [];\n      var links = [];\n      var outerId = [0];\n      data.forEach(function (d) {\n        if (d == null) return;\n        i = {\n          id: 'i' + inner.length,\n          name: d[0],\n          related_links: []\n        };\n        i.related_nodes = [i.id];\n        inner.push(i);\n        if (!Array.isArray(d[1])) d[1] = [d[1]];\n        d[1].forEach(function (d1) {\n          o = outer.get(d1);\n\n          if (o == null) {\n            o = {\n              name: d1,\n              id: 'o' + outerId[0],\n              related_links: []\n            };\n            o.related_nodes = [o.id];\n            outerId[0] = outerId[0] + 1;\n            outer.set(d1, o);\n          } // create the links\n\n\n          l = {\n            id: 'l-' + i.id + '-' + o.id,\n            inner: i,\n            outer: o\n          };\n          links.push(l); // and the relationships\n\n          i.related_nodes.push(o.id);\n          i.related_links.push(l.id);\n          o.related_nodes.push(i.id);\n          o.related_links.push(l.id);\n        });\n      });\n      data = {\n        inner: inner,\n        outer: outer.values(),\n        links: links // sort the data -- TODO: have multiple sort options\n\n      };\n      outer = data.outer;\n      data.outer = Array(outer.length);\n      var i1 = 0;\n      var i2 = outer.length - 1;\n\n      for (var i = 0; i < data.outer.length; ++i) {\n        if (i % 2 == 1) data.outer[i2--] = outer[i];else data.outer[i1++] = outer[i];\n      }\n\n      console.log(data.outer.reduce(function (a, b) {\n        return a + b.related_links.length;\n      }, 0) / data.outer.length); // from d3 colorbrewer: \n      // This product includes color specifications and designs developed by Cynthia Brewer (http://colorbrewer.org/).\n\n      var colors = [\"#a50026\", \"#d73027\", \"#f46d43\", \"#fdae61\", \"#fee090\", \"#ffffbf\", \"#e0f3f8\", \"#abd9e9\", \"#74add1\", \"#4575b4\", \"#313695\"];\n      var color = d3.scale.linear().domain([60, 220]).range([colors.length - 1, 0]).clamp(true);\n      var diameter = 960;\n      var rect_width = 40;\n      var rect_height = 14;\n      var link_width = \"1px\";\n      var il = data.inner.length;\n      var ol = data.outer.length;\n      var inner_y = d3.scale.linear().domain([0, il]).range([-(il * rect_height) / 2, il * rect_height / 2]);\n      mid = data.outer.length / 2.0;\n      var outer_x = d3.scale.linear().domain([0, mid, mid, data.outer.length]).range([15, 170, 190, 355]);\n      var outer_y = d3.scale.linear().domain([0, data.outer.length]).range([0, diameter / 2 - 120]); // setup positioning\n\n      data.outer = data.outer.map(function (d, i) {\n        d.x = outer_x(i);\n        d.y = diameter / 3;\n        return d;\n      });\n      data.inner = data.inner.map(function (d, i) {\n        d.x = -(rect_width / 2);\n        d.y = inner_y(i);\n        return d;\n      });\n\n      function get_color(name) {\n        var c = Math.round(color(name));\n        if (isNaN(c)) return '#dddddd'; // fallback color\n\n        return colors[c];\n      } // Can't just use d3.svg.diagonal because one edge is in normal space, the\n      // other edge is in radial space. Since we can't just ask d3 to do projection\n      // of a single point, do it ourselves the same way d3 would do it.  \n\n\n      function projectX(x) {\n        return (x - 90) / 180 * Math.PI - Math.PI / 2;\n      }\n\n      var diagonal = d3.svg.diagonal().source(function (d) {\n        return {\n          \"x\": d.outer.y * Math.cos(projectX(d.outer.x)),\n          \"y\": -d.outer.y * Math.sin(projectX(d.outer.x))\n        };\n      }).target(function (d) {\n        return {\n          \"x\": d.inner.y + rect_height / 2,\n          \"y\": d.outer.x > 180 ? d.inner.x : d.inner.x + rect_width\n        };\n      }).projection(function (d) {\n        return [d.y, d.x];\n      });\n      var svg = d3.select(\"body\").append(\"svg\").attr(\"width\", diameter).attr(\"height\", diameter).append(\"g\").attr(\"transform\", \"translate(\" + diameter / 2 + \",\" + diameter / 2 + \")\"); // links\n\n      var link = svg.append('g').attr('class', 'links').selectAll(\".link\").data(data.links).enter().append('path').attr('class', 'link').attr('id', function (d) {\n        return d.id;\n      }).attr(\"d\", diagonal).attr('stroke', function (d) {\n        return get_color(d.inner.name);\n      }).attr('stroke-width', link_width); // outer nodes\n\n      var onode = svg.append('g').selectAll(\".outer_node\").data(data.outer).enter().append(\"g\").attr(\"class\", \"outer_node\").attr(\"transform\", function (d) {\n        return \"rotate(\" + (d.x - 90) + \")translate(\" + d.y + \")\";\n      }).on(\"mouseover\", mouseover).on(\"mouseout\", mouseout);\n      onode.append(\"circle\").attr('id', function (d) {\n        return d.id;\n      }).attr(\"r\", 4.5);\n      onode.append(\"circle\").attr('r', 20).attr('visibility', 'hidden');\n      onode.append(\"text\").attr('id', function (d) {\n        return d.id + '-txt';\n      }).attr(\"dy\", \".31em\").attr(\"text-anchor\", function (d) {\n        return d.x < 180 ? \"start\" : \"end\";\n      }).attr(\"transform\", function (d) {\n        return d.x < 180 ? \"translate(8)\" : \"rotate(180)translate(-8)\";\n      }).text(function (d) {\n        return d.name;\n      }); // inner nodes\n\n      var inode = svg.append('g').selectAll(\".inner_node\").data(data.inner).enter().append(\"g\").attr(\"class\", \"inner_node\").attr(\"transform\", function (d, i) {\n        return \"translate(\" + d.x + \",\" + d.y + \")\";\n      }).on(\"mouseover\", mouseover).on(\"mouseout\", mouseout);\n      inode.append('rect').attr('width', rect_width).attr('height', rect_height).attr('id', function (d) {\n        return d.id;\n      }).attr('fill', function (d) {\n        return get_color(d.name);\n      });\n      inode.append(\"text\").attr('id', function (d) {\n        return d.id + '-txt';\n      }).attr('text-anchor', 'middle').attr(\"transform\", \"translate(\" + rect_width / 2 + \", \" + rect_height * .75 + \")\").text(function (d) {\n        return d.name;\n      }); // need to specify x/y/etc\n\n      d3.select(self.frameElement).style(\"height\", diameter - 150 + \"px\");\n\n      function mouseover(d) {\n        // bring to front\n        d3.selectAll('.links .link').sort(function (a, b) {\n          return d.related_links.indexOf(a.id);\n        });\n\n        for (var i = 0; i < d.related_nodes.length; i++) {\n          d3.select('#' + d.related_nodes[i]).classed('highlight', true);\n          d3.select('#' + d.related_nodes[i] + '-txt').attr(\"font-weight\", 'bold');\n        }\n\n        for (var i = 0; i < d.related_links.length; i++) {\n          d3.select('#' + d.related_links[i]).attr('stroke-width', '5px');\n        }\n      }\n\n      function mouseout(d) {\n        for (var i = 0; i < d.related_nodes.length; i++) {\n          d3.select('#' + d.related_nodes[i]).classed('highlight', false);\n          d3.select('#' + d.related_nodes[i] + '-txt').attr(\"font-weight\", 'normal');\n        }\n\n        for (var i = 0; i < d.related_links.length; i++) {\n          d3.select('#' + d.related_links[i]).attr('stroke-width', link_width);\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.CM();\n    } ////////// R E N D E R //////////\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      }, \"Line Graph Page\"), React.createElement(\"div\", {\n        className: \"dvContainer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"lgBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, {\n        LGW: LGW\n      }), React.createElement(\"div\", {\n        className: \"lgBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, {\n        LGE: LGE\n      })));\n    }\n  }]);\n\n  return DV3;\n}(React.Component);\n\nexport default DV3;","map":{"version":3,"sources":["/Users/silva/Desktop/code/MakeOrMiss/client/src/pages/DV3.js"],"names":["React","d3","WCdata","ECdata","DV3","data","outer","map","inner","links","outerId","forEach","d","i","id","length","name","related_links","related_nodes","push","Array","isArray","d1","o","get","set","l","values","i1","i2","console","log","reduce","a","b","colors","color","scale","linear","domain","range","clamp","diameter","rect_width","rect_height","link_width","il","ol","inner_y","mid","outer_x","outer_y","x","y","get_color","c","Math","round","isNaN","projectX","PI","diagonal","svg","source","cos","sin","target","projection","select","append","attr","link","selectAll","enter","onode","on","mouseover","mouseout","text","inode","self","frameElement","style","sort","indexOf","classed","CM","LGW","LGE","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport * as d3 from \"d3\";\nimport WCdata from '../assets/wclinedata.csv'; \nimport ECdata from '../assets/eclinedata.csv';\n\nclass DV3 extends React.Component {\n\n  CM() {\n    var data = [[120, [\"like\", \"call response\", \"dramatic intro\", \"has breaks\", \"male vocalist\", \"silly\", \"swing\"]], [150, [\"brassy\", \"like\", \"calm energy\", \"female vocalist\", \"swing\", \"fun\"]], [170, [\"calm energy\", \"instrumental\", \"swing\", \"like\", \"happy\"]], [140, [\"has breaks\", \"male vocalist\", \"swing\", \"piano\", \"banjo\", \"chill\"]], [160, [\"calm energy\", \"instrumental\", \"swing\", \"like\", \"interesting\"]], [140, [\"brassy\", \"like\", \"energy\", \"dramatic intro\", \"male vocalist\", \"baseball\", \"swing\"]], [170, [\"instrumental\", \"interesting\", \"high energy\", \"like\", \"swing\"]], [140, [\"instrumental\", \"energy\", \"like\", \"swing\"]], [200, [\"instrumental\", \"brassy\", \"dramatic intro\", \"like\", \"swing\"]], [160, [\"male vocalist\", \"brassy\", \"swing\", \"like\", \"my favorites\"]], [130, [\"like\", \"interesting\", \"dramatic intro\", \"male vocalist\", \"silly\", \"swing\", \"gospel\"]], [160, [\"like\", \"long intro\", \"announcer\", \"energy\", \"swing\", \"female vocalist\"]], [170, [\"instrumental\", \"swing\", \"bass\", \"like\"]], [150, [\"like\", \"interesting\", \"has breaks\", \"instrumental\", \"chunky\", \"swing\", \"banjo\", \"trumpet\"]], [170, [\"like\", \"has breaks\", \"male vocalist\", \"silly\", \"swing\", \"banjo\"]], [190, [\"instrumental\", \"banjo\", \"swing\"]], [130, [\"instrumental\", \"brassy\", \"banjo\", \"like\", \"swing\"]], [160, [\"brassy\", \"like\", \"energy\", \"instrumental\", \"big band\", \"jam\", \"swing\"]], [150, [\"like\", \"male vocalist\", \"live\", \"swing\", \"piano\", \"banjo\", \"chill\"]], [150, [\"like\", \"trick ending\", \"instrumental\", \"chunky\", \"swing\", \"chill\"]], [120, [\"brassy\", \"like\", \"female vocalist\", \"swing\", \"chill\", \"energy buildup\"]], [150, [\"brassy\", \"like\", \"interesting\", \"instrumental\", \"swing\", \"piano\"]], [190, [\"brassy\", \"like\", \"long intro\", \"energy\", \"baseball\", \"swing\", \"female vocalist\"]], [180, [\"calm energy\", \"female vocalist\", \"live\", \"like\", \"swing\"]], [200, [\"banjo\", \"like\", \"long intro\", \"interesting\", \"energy\", \"my favorites\", \"male vocalist\", \"silly\", \"swing\", \"fun\", \"balboa\"]], [150, [\"brassy\", \"calm energy\", \"chunky\", \"instrumental\", \"old-timey\", \"live\", \"swing\"]], [160, [\"like\", \"call response\", \"interesting\", \"instrumental\", \"calm energy\", \"swing\"]], [180, [\"interesting\", \"swing\", \"fast\", \"male vocalist\"]], [150, [\"calm energy\", \"chunky\", \"swing\", \"female vocalist\", \"like\"]], [180, [\"like\", \"has breaks\", \"male vocalist\", \"chunky\", \"silly\", \"swing\"]], [140, [\"instrumental\", \"brassy\", \"dramatic intro\", \"swing\", \"chill\"]], [150, [\"male vocalist\", \"trumpet\", \"like\", \"swing\"]], [150, [\"instrumental\", \"energy\", \"like\", \"has breaks\", \"swing\"]], [180, [\"brassy\", \"like\", \"energy\", \"has breaks\", \"instrumental\", \"has calm\", \"swing\"]], [150, [\"female vocalist\", \"swing\"]], [170, [\"instrumental\", \"brassy\", \"energy\", \"swing\"]], [170, [\"calm energy\", \"instrumental\", \"energy\", \"like\", \"swing\"]], [190, [\"brassy\", \"like\", \"instrumental\", \"high energy\", \"swing\", \"trumpet\"]], [160, [\"male vocalist\", \"energy\", \"swing\", \"old-timey\"]], [170, [\"like\", \"oldies\", \"my favorites\", \"fast\", \"male vocalist\", \"high energy\", \"swing\"]]];\n\n// transform the data into a useful representation\n// 1 is inner, 2, is outer\n\n// need: inner, outer, links\n//\n// inner: \n// links: { inner: outer: }\n\n\nvar outer = d3.map();\nvar inner = [];\nvar links = [];\n\nvar outerId = [0];\n\ndata.forEach(function(d){\n\t\n\tif (d == null)\n\t\treturn;\n\t\n\ti = { id: 'i' + inner.length, name: d[0], related_links: [] };\n\ti.related_nodes = [i.id];\n\tinner.push(i);\n\t\n\tif (!Array.isArray(d[1]))\n\t\td[1] = [d[1]];\n\t\n\td[1].forEach(function(d1){\n\t\t\n\t\to = outer.get(d1);\n\t\t\n\t\tif (o == null)\n\t\t{\n\t\t\to = { name: d1,\tid: 'o' + outerId[0], related_links: [] };\n\t\t\to.related_nodes = [o.id];\n\t\t\touterId[0] = outerId[0] + 1;\t\n\t\t\t\n\t\t\touter.set(d1, o);\n\t\t}\n\t\t\n\t\t// create the links\n\t\tl = { id: 'l-' + i.id + '-' + o.id, inner: i, outer: o }\n\t\tlinks.push(l);\n\t\t\n\t\t// and the relationships\n\t\ti.related_nodes.push(o.id);\n\t\ti.related_links.push(l.id);\n\t\to.related_nodes.push(i.id);\n\t\to.related_links.push(l.id);\n\t});\n});\n\ndata = {\n\tinner: inner,\n\touter: outer.values(),\n\tlinks: links\n}\n\n// sort the data -- TODO: have multiple sort options\nouter = data.outer;\ndata.outer = Array(outer.length);\n\n\nvar i1 = 0;\nvar i2 = outer.length - 1;\n\nfor (var i = 0; i < data.outer.length; ++i)\n{\n\tif (i % 2 == 1)\n\t\tdata.outer[i2--] = outer[i];\n\telse\n\t\tdata.outer[i1++] = outer[i];\n}\n\nconsole.log(data.outer.reduce(function(a,b) { return a + b.related_links.length; }, 0) / data.outer.length);\n\n\n// from d3 colorbrewer: \n// This product includes color specifications and designs developed by Cynthia Brewer (http://colorbrewer.org/).\nvar colors = [\"#a50026\",\"#d73027\",\"#f46d43\",\"#fdae61\",\"#fee090\",\"#ffffbf\",\"#e0f3f8\",\"#abd9e9\",\"#74add1\",\"#4575b4\",\"#313695\"]\nvar color = d3.scale.linear()\n    .domain([60, 220])\n    .range([colors.length-1, 0])\n    .clamp(true);\n\nvar diameter = 960;\nvar rect_width = 40;\nvar rect_height = 14;\n\nvar link_width = \"1px\"; \n\nvar il = data.inner.length;\nvar ol = data.outer.length;\n\nvar inner_y = d3.scale.linear()\n    .domain([0, il])\n    .range([-(il * rect_height)/2, (il * rect_height)/2]);\n\nmid = (data.outer.length/2.0)\nvar outer_x = d3.scale.linear()\n    .domain([0, mid, mid, data.outer.length])\n    .range([15, 170, 190 ,355]);\n\nvar outer_y = d3.scale.linear()\n    .domain([0, data.outer.length])\n    .range([0, diameter / 2 - 120]);\n\n\n// setup positioning\ndata.outer = data.outer.map(function(d, i) { \n    d.x = outer_x(i);\n    d.y = diameter/3;\n    return d;\n});\n\ndata.inner = data.inner.map(function(d, i) { \n    d.x = -(rect_width / 2);\n    d.y = inner_y(i);\n    return d;\n});\n\n\nfunction get_color(name)\n{\n    var c = Math.round(color(name));\n    if (isNaN(c))\n        return '#dddddd';\t// fallback color\n    \n    return colors[c];\n}\n\n// Can't just use d3.svg.diagonal because one edge is in normal space, the\n// other edge is in radial space. Since we can't just ask d3 to do projection\n// of a single point, do it ourselves the same way d3 would do it.  \n\n\nfunction projectX(x)\n{\n    return ((x - 90) / 180 * Math.PI) - (Math.PI/2);\n}\n\nvar diagonal = d3.svg.diagonal()\n    .source(function(d) { return {\"x\": d.outer.y * Math.cos(projectX(d.outer.x)), \n                                  \"y\": -d.outer.y * Math.sin(projectX(d.outer.x))}; })            \n    .target(function(d) { return {\"x\": d.inner.y + rect_height/2,\n                                  \"y\": d.outer.x > 180 ? d.inner.x : d.inner.x + rect_width}; })\n    .projection(function(d) { return [d.y, d.x]; });\n\n\nvar svg = d3.select(\"body\").append(\"svg\")\n    .attr(\"width\", diameter)\n    .attr(\"height\", diameter)\n  .append(\"g\")\n    .attr(\"transform\", \"translate(\" + diameter / 2 + \",\" + diameter / 2 + \")\");\n    \n\n// links\nvar link = svg.append('g').attr('class', 'links').selectAll(\".link\")\n    .data(data.links)\n  .enter().append('path')\n    .attr('class', 'link')\n    .attr('id', function(d) { return d.id })\n    .attr(\"d\", diagonal)\n    .attr('stroke', function(d) { return get_color(d.inner.name); })\n    .attr('stroke-width', link_width);\n\n// outer nodes\n\nvar onode = svg.append('g').selectAll(\".outer_node\")\n    .data(data.outer)\n  .enter().append(\"g\")\n    .attr(\"class\", \"outer_node\")\n    .attr(\"transform\", function(d) { return \"rotate(\" + (d.x - 90) + \")translate(\" + d.y + \")\"; })\n    .on(\"mouseover\", mouseover)\n    .on(\"mouseout\", mouseout);\n  \nonode.append(\"circle\")\n    .attr('id', function(d) { return d.id })\n    .attr(\"r\", 4.5);\n  \nonode.append(\"circle\")\n    .attr('r', 20)\n    .attr('visibility', 'hidden');\n  \nonode.append(\"text\")\n\t.attr('id', function(d) { return d.id + '-txt'; })\n    .attr(\"dy\", \".31em\")\n    .attr(\"text-anchor\", function(d) { return d.x < 180 ? \"start\" : \"end\"; })\n    .attr(\"transform\", function(d) { return d.x < 180 ? \"translate(8)\" : \"rotate(180)translate(-8)\"; })\n    .text(function(d) { return d.name; });\n  \n// inner nodes\n  \nvar inode = svg.append('g').selectAll(\".inner_node\")\n    .data(data.inner)\n  .enter().append(\"g\")\n    .attr(\"class\", \"inner_node\")\n    .attr(\"transform\", function(d, i) { return \"translate(\" + d.x + \",\" + d.y + \")\"})\n    .on(\"mouseover\", mouseover)\n    .on(\"mouseout\", mouseout);\n  \ninode.append('rect')\n    .attr('width', rect_width)\n    .attr('height', rect_height)\n    .attr('id', function(d) { return d.id; })\n    .attr('fill', function(d) { return get_color(d.name); });\n  \ninode.append(\"text\")\n\t.attr('id', function(d) { return d.id + '-txt'; })\n    .attr('text-anchor', 'middle')\n    .attr(\"transform\", \"translate(\" + rect_width/2 + \", \" + rect_height * .75 + \")\")\n    .text(function(d) { return d.name; });\n\n// need to specify x/y/etc\n\nd3.select(self.frameElement).style(\"height\", diameter - 150 + \"px\");\n\nfunction mouseover(d)\n{\n\t// bring to front\n\td3.selectAll('.links .link').sort(function(a, b){ return d.related_links.indexOf(a.id); });\t\n\t\n    for (var i = 0; i < d.related_nodes.length; i++)\n    {\n        d3.select('#' + d.related_nodes[i]).classed('highlight', true);\n        d3.select('#' + d.related_nodes[i] + '-txt').attr(\"font-weight\", 'bold');\n    }\n    \n    for (var i = 0; i < d.related_links.length; i++)\n        d3.select('#' + d.related_links[i]).attr('stroke-width', '5px');\n}\n\nfunction mouseout(d)\n{   \t\n    for (var i = 0; i < d.related_nodes.length; i++)\n    {\n        d3.select('#' + d.related_nodes[i]).classed('highlight', false);\n        d3.select('#' + d.related_nodes[i] + '-txt').attr(\"font-weight\", 'normal');\n    }\n    \n    for (var i = 0; i < d.related_links.length; i++)\n        d3.select('#' + d.related_links[i]).attr('stroke-width', link_width);\n}\n\n\n\n  }\n\n\n  componentDidMount() {\n      this.CM()\n  }\n\n\n  ////////// R E N D E R //////////\n\n  render() {\n    return (\n      <div>\n        <h1>Line Graph Page</h1>\n        <div className=\"dvContainer\">\n        <div className=\"lgBox\">{{LGW}}</div>\n        <div className=\"lgBox\">{{LGE}}</div>\n        </div>\n\n      </div>\n    )\n  }\n\n}\nexport default DV3;"]},"metadata":{},"sourceType":"module"}